# Каталог книг на Yii2

Веб‑приложение демонстрирует каталог книг.

## Основные возможности

- CRUD для книг и авторов с поддержкой нескольких авторов у одной книги.
- Загрузка обложек книг и хранение в файловой системе (`web/uploads/books`).
- Подписка гостей на авторов с отправкой SMS-уведомлений через SmsPilot (в тестовом режиме).
- Отчет «ТОП-10 авторов по количеству книг за год».
- REST API для сущности `Book` по адресу `/api/books`.
- Навигация по разделам каталога, авторам и отчету.

## Структура

- `controllers/` — тонкие контроллеры, делегирующие действия классам в `actions/`.
- `actions/` — классы действий для CRUD и отчетов, подключают сервисы.
- `services/` — бизнес-логика (книги, авторы, подписки, уведомления, отчеты).
- `models/` — ActiveRecord модели, формы и поисковые модели.
- `components/` — клиент SmsPilot, сервис уведомлений и генератор отчета.
- `views/` — Bootstrap 5 интерфейс.
- `migrations/` — миграции БД (таблицы книг, авторов, связей, подписок).

## Настройка окружения

1. Установите зависимости composer внутри контейнера (пример для Docker):
   ```bash
   docker-compose run --rm php composer install
   ```
2. Примените миграции:
   ```bash
   docker-compose exec php php yii migrate
   ```
3. Запустите контейнер:
   ```bash
   docker-compose up -d
   ```
4. Приложение будет доступно по адресу `http://localhost:8666`.

## Конфигурация SMS

Компонент `smsPilot` использует ключ `EMULATOR`, что означает запись сообщений в лог без реальной отправки. Чтобы подключить реальную SMS-рассылку, задайте переменную окружения `SMS_PILOT_API_KEY` в конфигурации контейнера. После этого компонент перейдет в рабочий режим.

## Тестовые пользователи

В базовом шаблоне предусмотрены пользователи `admin/admin` и `demo/demo`, указанные в `models/User.php`. Для портала можно адаптировать систему регистрации или внедрить полноценную таблицу пользователей при необходимости.

